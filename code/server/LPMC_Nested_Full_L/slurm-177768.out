Starting optimization of LPMC_Nested_Full_L with LS and bfgs-inv at lun ao√ª 12 14:36:26 CEST 2019
Train LPMC_Nested_Full_L with LS and bfgs-inv
Traceback (most recent call last):
  File "LS_bfgs-inv.py", line 30, in <module>
    tmp = model.optimize(ioa, **{'verbose': False, 'nbr_epochs': 1000, 'batch': 1000})
  File "../../models/LPMC_Nested_Full.py", line 826, in optimize
    return algo.solve(maximize=True)
  File "../../algos/OptAlg.py", line 215, in solve
    xk_new = self.alg_type.update_xk(xk, fk, gk, Bk, f, fprime, self.dir, self.fs)
  File "../../algos/types/LineSearch.py", line 34, in update_xk
    alpha = self.compute_alpha(f, fprime, xk, direction, fs)
  File "../../algos/types/LineSearch.py", line 24, in compute_alpha
    alpha = ls_wolfe12(f, fprime, xk, direction, gk, fs[-1], old_old_fval)
  File "../../algos/types/helpers.py", line 17, in ls_wolfe12
    old_fval, old_old_fval)
  File "/ssoft/spack/paien/v2/opt/spack/linux-rhel7-x86_E5v4_Mellanox/gcc-7.3.0/python-3.6.5-fuxsuhr3v4fh4gdkw6xrvnctzn2meygg/lib/python3.6/site-packages/scipy/optimize/linesearch.py", line 101, in line_search_wolfe1
    c1=c1, c2=c2, amax=amax, amin=amin, xtol=xtol)
  File "/ssoft/spack/paien/v2/opt/spack/linux-rhel7-x86_E5v4_Mellanox/gcc-7.3.0/python-3.6.5-fuxsuhr3v4fh4gdkw6xrvnctzn2meygg/lib/python3.6/site-packages/scipy/optimize/linesearch.py", line 174, in scalar_search_wolfe1
    phi1 = phi(stp)
  File "/ssoft/spack/paien/v2/opt/spack/linux-rhel7-x86_E5v4_Mellanox/gcc-7.3.0/python-3.6.5-fuxsuhr3v4fh4gdkw6xrvnctzn2meygg/lib/python3.6/site-packages/scipy/optimize/linesearch.py", line 87, in phi
    return f(xk + s*pk, *args)
  File "../../algos/directions/BFGS_INV.py", line 40, in f
    return self.mult * self.f(x)
  File "../../algos/directions/Direction.py", line 15, in <lambda>
    self.f = lambda x: self.biogeme.calculateLikelihood(x)
  File "/home/glederre/pybio/lib/python3.6/site-packages/biogeme/biogeme.py", line 250, in calculateLikelihood
    f = self.theC.calculateLikelihood(x,self.fixedBetaValues)
  File "src/cbiogeme.pyx", line 93, in biogeme.cbiogeme.pyBiogeme.calculateLikelihood
RuntimeError: src/biogeme.cc:296: Biogeme exception: Error for data entry 57842 : src/bioExprElem.cc:66: Biogeme exception: Invalid value for expression <(exp((((((((((((((((((((((((ASC_DRIVING_DL0[1] <57842>*dl0[363] <57842>)+(ASC_DRIVING_DL1[2] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((ASC_DRIVING_DL0[1] <57842>*dl0[363] <57842>)+(ASC_DRIVING_DL1[2] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((ASC_DRIVING_DL0[1] <57842>*dl0[363] <57842>)+(ASC_DRIVING_DL1[2] <57842>*dl1[364] <57842>))*co2[352] <57842>))+((((((B_TIME_DRIVING_NCO[85] <57842>*dl0[363] <57842>)+(B_TIME_DRIVING_NCO[85] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_TIME_DRIVING_CO1_DL0[81] <57842>*dl0[363] <57842>)+(B_TIME_DRIVING_CO1_DL1[82] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_TIME_DRIVING_CO2_DL0[83] <57842>*dl0[363] <57842>)+(B_TIME_DRIVING_CO2_DL1[84] <57842>*dl1[364] <57842>))*co2[352] <57842>))*dur_driving[309] <57842>))+((((((B_COST_CON_NCO_DL0[151] <57842>*dl0[363] <57842>)+(B_COST_CON_NCO_DL1[152] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_COST_CON_CO[23] <57842>*dl0[363] <57842>)+(B_COST_CON_CO[23] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_COST_CON_CO[23] <57842>*dl0[363] <57842>)+(B_COST_CON_CO[23] <57842>*dl1[364] <57842>))*co2[352] <57842>))*con_charge[341] <57842>))+((((((B_COST_FUEL_NCO_DL0[156] <57842>*dl0[363] <57842>)+(B_COST_FUEL_NCO_DL1[25] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_COST_FUEL_CO1_DL0[153] <57842>*dl0[363] <57842>)+(B_COST_FUEL_CO1_DL1[154] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_COST_FUEL_CO2_DL0[155] <57842>*dl0[363] <57842>)+(B_COST_FUEL_CO2_DL1[24] <57842>*dl1[364] <57842>))*co2[352] <57842>))*cost_driving[312] <57842>))+((((((B_TRAFFIC_DL0[93] <57842>*dl0[363] <57842>)+(B_TRAFFIC_NCO1_DL1[94] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_TRAFFIC_DL0[93] <57842>*dl0[363] <57842>)+(B_TRAFFIC_NCO1_DL1[94] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_TRAFFIC_DL0[93] <57842>*dl0[363] <57842>)+(B_TRAFFIC_CO2_DL1[92] <57842>*dl1[364] <57842>))*co2[352] <57842>))*traffic_percent[313] <57842>))+((((((B_PURPOSE_B_DRIVING_NCO_DL0[207] <57842>*dl0[363] <57842>)+(B_PURPOSE_B_DRIVING_NCO_DL1[208] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_PURPOSE_B_DRIVING_CO1_DL0[205] <57842>*dl0[363] <57842>)+(B_PURPOSE_B_DRIVING_CO1_DL1[206] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_PURPOSE_B_DRIVING_CO2[54] <57842>*dl0[363] <57842>)+(B_PURPOSE_B_DRIVING_CO2[54] <57842>*dl1[364] <57842>))*co2[352] <57842>))*purpose_B[342] <57842>))+((((((B_PURPOSE_HBW_DRIVING_NCO[69] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBW_DRIVING_NCO[69] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_PURPOSE_HBW_DRIVING_CO1_DL0[67] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBW_DRIVING_CO1_DL1[68] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_PURPOSE_HBW_DRIVING_CO2_DL0[244] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBW_DRIVING_CO2_DL1[245] <57842>*dl1[364] <57842>))*co2[352] <57842>))*purpose_HBW[328] <57842>))+((((((B_PURPOSE_HBE_DRIVING_NCO[59] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBE_DRIVING_NCO[59] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_PURPOSE_HBE_DRIVING_CO_DL0[58] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBE_DRIVING_CO1_DL1[57] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_PURPOSE_HBE_DRIVING_CO_DL0[58] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBE_DRIVING_CO2_DL1[217] <57842>*dl1[364] <57842>))*co2[352] <57842>))*purpose_HBE[326] <57842>))+((((((B_PURPOSE_HBO_DRIVING_NCO_DL0[230] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBO_DRIVING_NCO_DL1[231] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_PURPOSE_HBO_DRIVING_CO_DL0[229] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBO_DRIVING_CO_DL1[63] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_PURPOSE_HBO_DRIVING_CO_DL0[229] <57842>*dl0[363] <57842>)+(B_PURPOSE_HBO_DRIVING_CO_DL1[63] <57842>*dl1[364] <57842>))*co2[352] <57842>))*purpose_HBO[327] <57842>))+((((((B_FEMALE_DRIVING_DL0[37] <57842>*dl0[363] <57842>)+(B_FEMALE_DRIVING_NCO_DL1[168] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_FEMALE_DRIVING_DL0[37] <57842>*dl0[363] <57842>)+(B_FEMALE_DRIVING_CO_DL1[167] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_FEMALE_DRIVING_DL0[37] <57842>*dl0[363] <57842>)+(B_FEMALE_DRIVING_CO_DL1[167] <57842>*dl1[364] <57842>))*co2[352] <57842>))*female[318] <57842>))+((((((B_WINTER_DRIVING_NCO_DL0[291] <57842>*dl0[363] <57842>)+(B_WINTER_DRIVING_NCO_DL1[292] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_WINTER_DRIVING_CO[99] <57842>*dl0[363] <57842>)+(B_WINTER_DRIVING_CO[99] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_WINTER_DRIVING_CO[99] <57842>*dl0[363] <57842>)+(B_WINTER_DRIVING_CO[99] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.winter[358] <57842>))+((((((B_CHILD_DRIVING_NCO_DL0[21] <57842>*dl0[363] <57842>)+(B_CHILD_DRIVING_NCO_DL1[139] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_CHILD_DRIVING_CO1_DL0[19] <57842>*dl0[363] <57842>)+(B_CHILD_DRIVING_CO1_DL1[137] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_CHILD_DRIVING_CO2_DL0[20] <57842>*dl0[363] <57842>)+(B_CHILD_DRIVING_CO2_DL1[138] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.child[355] <57842>))+((((((B_CADULT_DRIVING_NCO2_DL0[121] <57842>*dl0[363] <57842>)+(B_CADULT_DRIVING_NCO2_DL1[15] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_CADULT_DRIVING_CO1_DL0[13] <57842>*dl0[363] <57842>)+(B_CADULT_DRIVING_CO1_DL1[14] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_CADULT_DRIVING_NCO2_DL0[121] <57842>*dl0[363] <57842>)+(B_CADULT_DRIVING_NCO2_DL1[15] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.cadult[356] <57842>))+((((((B_ADULT_DRIVING_NCO_DL0[7] <57842>*dl0[363] <57842>)+(B_ADULT_DRIVING_NCO_DL1[8] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_ADULT_DRIVING_CO1_DL0[109] <57842>*dl0[363] <57842>)+(B_ADULT_DRIVING_CO1_DL1[110] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_ADULT_DRIVING_CO2_DL0[111] <57842>*dl0[363] <57842>)+(B_ADULT_DRIVING_CO2_DL1[6] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.adult[357] <57842>))+((((((B_WEEKDAY_DRIVING_NCO1_DL0[95] <57842>*dl0[363] <57842>)+(B_WEEKDAY_DRIVING_NCO1_DL1[96] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_WEEKDAY_DRIVING_NCO1_DL0[95] <57842>*dl0[363] <57842>)+(B_WEEKDAY_DRIVING_NCO1_DL1[96] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_WEEKDAY_DRIVING_CO2_DL0[278] <57842>*dl0[363] <57842>)+(B_WEEKDAY_DRIVING_CO2_DL1[279] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.weekday[353] <57842>))+((((((B_INTER_PEAK_DRIVING_NCO_DL0[181] <57842>*dl0[363] <57842>)+(B_INTER_PEAK_DRIVING_NCO_DL1[182] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_INTER_PEAK_DRIVING_CO1_DL0[179] <57842>*dl0[363] <57842>)+(B_INTER_PEAK_DRIVING_CO1_DL1[180] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_INTER_PEAK_DRIVING_CO2_DL0[40] <57842>*dl0[363] <57842>)+(B_INTER_PEAK_DRIVING_CO2_DL1[41] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.interpeak[360] <57842>))+((((((B_PM_PEAK_DRIVING_DL0[50] <57842>*dl0[363] <57842>)+(B_PM_PEAK_DRIVING_DL1[51] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_PM_PEAK_DRIVING_DL0[50] <57842>*dl0[363] <57842>)+(B_PM_PEAK_DRIVING_DL1[51] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_PM_PEAK_DRIVING_DL0[50] <57842>*dl0[363] <57842>)+(B_PM_PEAK_DRIVING_DL1[51] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.pmpeak[359] <57842>))+((((((B_DISTANCE_DRIVING_NCO_DL0[32] <57842>*dl0[363] <57842>)+(B_DISTANCE_DRIVING_DL1[31] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_DISTANCE_DRIVING_CO_DL0[30] <57842>*dl0[363] <57842>)+(B_DISTANCE_DRIVING_DL1[31] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_DISTANCE_DRIVING_CO_DL0[30] <57842>*dl0[363] <57842>)+(B_DISTANCE_DRIVING_DL1[31] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.distance_km[361] <57842>))+((((((B_LOGDISTANCE_DRIVING_NCO_DL0[45] <57842>*dl0[363] <57842>)+(B_LOGDISTANCE_DRIVING_NCO_DL1[46] <57842>*dl1[364] <57842>))*co0[350] <57842>)+(((B_LOGDISTANCE_DRIVING_CO_DL0[43] <57842>*dl0[363] <57842>)+(B_LOGDISTANCE_DRIVING_CO_DL1[44] <57842>*dl1[364] <57842>))*co1[351] <57842>))+(((B_LOGDISTANCE_DRIVING_CO_DL0[43] <57842>*dl0[363] <57842>)+(B_LOGDISTANCE_DRIVING_CO_DL1[44] <57842>*dl1[364] <57842>))*co2[352] <57842>))*self.logdistance[362] <57842>)))^1)>: inf
srun: error: h020: task 0: Exited with exit code 1
srun: Terminating job step 177768.0
Finished at lun ao√ª 12 14:37:35 CEST 2019
